<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ReveilLib: rev::PilonsCorrection Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ReveilLib
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classrev_1_1PilonsCorrection.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classrev_1_1PilonsCorrection-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">rev::PilonsCorrection Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implements the PiLons <a class="el" href="classrev_1_1Correction.html" title="Interface for correction algorithms.">Correction</a> Algorithm used by team 5225A in VRC In The Zone.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="pilons__correction_8hh_source.html">pilons_correction.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for rev::PilonsCorrection:</div>
<div class="dyncontent">
<div class="center"><img src="classrev_1_1PilonsCorrection__inherit__graph.png" border="0" usemap="#arev_1_1PilonsCorrection_inherit__map" alt="Inheritance graph"/></div>
<map name="arev_1_1PilonsCorrection_inherit__map" id="arev_1_1PilonsCorrection_inherit__map">
<area shape="rect" title="Implements the PiLons Correction Algorithm used by team 5225A in VRC In The Zone." alt="" coords="5,79,146,105"/>
<area shape="rect" href="classrev_1_1Correction.html" title="Interface for correction algorithms." alt="" coords="23,5,128,31"/>
<area shape="poly" title=" " alt="" coords="78,46,78,79,73,79,73,46"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for rev::PilonsCorrection:</div>
<div class="dyncontent">
<div class="center"><img src="classrev_1_1PilonsCorrection__coll__graph.png" border="0" usemap="#arev_1_1PilonsCorrection_coll__map" alt="Collaboration graph"/></div>
<map name="arev_1_1PilonsCorrection_coll__map" id="arev_1_1PilonsCorrection_coll__map">
<area shape="rect" title="Implements the PiLons Correction Algorithm used by team 5225A in VRC In The Zone." alt="" coords="5,79,146,105"/>
<area shape="rect" href="classrev_1_1Correction.html" title="Interface for correction algorithms." alt="" coords="23,5,128,31"/>
<area shape="poly" title=" " alt="" coords="78,46,78,79,73,79,73,46"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9b7c4b1093a1f6690a0a4bb490dcc446" id="r_a9b7c4b1093a1f6690a0a4bb490dcc446"><td class="memItemLeft" align="right" valign="top">std::tuple&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9b7c4b1093a1f6690a0a4bb490dcc446">apply_correction</a> (<a class="el" href="structrev_1_1OdometryState.html">OdometryState</a> current_state, <a class="el" href="namespacerev.html#a032bee8fc59a38d427e7be078e6653b8">Position</a> target_state, <a class="el" href="namespacerev.html#a032bee8fc59a38d427e7be078e6653b8">Position</a> start_state, QLength drop_early, std::tuple&lt; double, double &gt; powers) override</td></tr>
<tr class="memdesc:a9b7c4b1093a1f6690a0a4bb490dcc446"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies correction to the input.  <br /></td></tr>
<tr class="separator:a9b7c4b1093a1f6690a0a4bb490dcc446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe3fbb2ac90ee22ab6b55bdd9fb7e2c6" id="r_afe3fbb2ac90ee22ab6b55bdd9fb7e2c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe3fbb2ac90ee22ab6b55bdd9fb7e2c6">PilonsCorrection</a> (double ik_correction, QLength imax_error)</td></tr>
<tr class="memdesc:afe3fbb2ac90ee22ab6b55bdd9fb7e2c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new Pilons <a class="el" href="classrev_1_1Correction.html" title="Interface for correction algorithms.">Correction</a> object.  <br /></td></tr>
<tr class="separator:afe3fbb2ac90ee22ab6b55bdd9fb7e2c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5443f6dbeb8ac363289ffcc53f47bdaa" id="r_a5443f6dbeb8ac363289ffcc53f47bdaa"><td class="memItemLeft" align="right" valign="top"><a id="a5443f6dbeb8ac363289ffcc53f47bdaa" name="a5443f6dbeb8ac363289ffcc53f47bdaa"></a>
std::shared_ptr&lt; <a class="el" href="classrev_1_1PilonsCorrection.html">PilonsCorrection</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>operator&amp;</b> ()</td></tr>
<tr class="separator:a5443f6dbeb8ac363289ffcc53f47bdaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements the PiLons <a class="el" href="classrev_1_1Correction.html" title="Interface for correction algorithms.">Correction</a> Algorithm used by team 5225A in VRC In The Zone. </p>
<p>PiLons correction follows the following:</p>
<ol type="1">
<li>Find the distance from the target position to the nearest point on the line the robot is currently following. Save this as <code>xerr</code></li>
<li>Calculate the global angle from where the robot is to the target point</li>
<li>Find the difference in the angle the robot is facing to the angle the robot needs to face to be facing towards the target point. This should be the minimum angle needed. <a class="el" href="classrev_1_1Call.html">Call</a> this <code>angle</code>.</li>
<li>If <code>xerr</code> is greater than the maximum allowable <code>xerr</code>, <code>correction = k</code></li>
</ol>
<p><code>angle</code></p><ol type="1">
<li>If <code>correction == 0</code>, skip correcting. If <code>correction &gt; 0</code>, multiply the right power by <code>exp(-correction)</code>. If <code>correction &lt; 0</code>, multiply left power by <code>exp(correction)</code> </li>
</ol>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="afe3fbb2ac90ee22ab6b55bdd9fb7e2c6" name="afe3fbb2ac90ee22ab6b55bdd9fb7e2c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe3fbb2ac90ee22ab6b55bdd9fb7e2c6">&#9670;&#160;</a></span>PilonsCorrection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rev::PilonsCorrection::PilonsCorrection </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ik_correction</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QLength</td>          <td class="paramname"><span class="paramname"><em>imax_error</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a new Pilons <a class="el" href="classrev_1_1Correction.html" title="Interface for correction algorithms.">Correction</a> object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ikCorrection</td><td>The constant of correction. <code>8.0</code> was used by Pilons, but tuning is recommended. </td></tr>
    <tr><td class="paramname">imaxError</td><td>The error threshold over which correction will be applied </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9b7c4b1093a1f6690a0a4bb490dcc446" name="a9b7c4b1093a1f6690a0a4bb490dcc446"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b7c4b1093a1f6690a0a4bb490dcc446">&#9670;&#160;</a></span>apply_correction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::tuple&lt; double, double &gt; rev::PilonsCorrection::apply_correction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrev_1_1OdometryState.html">rev::OdometryState</a></td>          <td class="paramname"><span class="paramname"><em>current_state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacerev.html#a032bee8fc59a38d427e7be078e6653b8">rev::Position</a></td>          <td class="paramname"><span class="paramname"><em>target_state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacerev.html#a032bee8fc59a38d427e7be078e6653b8">Position</a></td>          <td class="paramname"><span class="paramname"><em>start_state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QLength</td>          <td class="paramname"><span class="paramname"><em>drop_early</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::tuple&lt; double, double &gt;</td>          <td class="paramname"><span class="paramname"><em>powers</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel override">override</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Applies correction to the input. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current <a class="el" href="structrev_1_1OdometryState.html" title="A structure packaging a velocity and position into one.">OdometryState</a> </td></tr>
    <tr><td class="paramname">target_state</td><td>The position being targeted </td></tr>
    <tr><td class="paramname">powers</td><td>The input powers </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::tuple&lt;double, double&gt; The adjusted powers </dd></dl>

<p>Implements <a class="el" href="classrev_1_1Correction.html#a6e7635a2eb59c2db1dffaf505e5305bc">rev::Correction</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/rev/api/alg/drive/correction/<a class="el" href="pilons__correction_8hh_source.html">pilons_correction.hh</a></li>
<li>src/api/alg/drive/correction/<b>pilons_correction.cc</b></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacerev.html">rev</a></li><li class="navelem"><a class="el" href="classrev_1_1PilonsCorrection.html">PilonsCorrection</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
